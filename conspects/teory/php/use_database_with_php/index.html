<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <h1>Работа с БД из MySql средствами php</h1>
    <p>Для того что бы подключиться к БД, создаем переменную <b>connection</b> которая будет экземпляром класса <b>PDO</b> (php data object). PDO - это встроенная в php библиотека с методами по работе с базами данных. Существуют еще бблиотеки mysql и mysqlli - но они считаются устаревшими. </p>
    <img src="./img1.jpg" alt="">
    <ul>
        <li><b>mysql:host=localhost</b> - здесь мы указываем используемую СУБД, а так же хост где развернута База данный</li>
        <li><b>dbname=lesson_php</b> - далее мы указываем название нашей БД, к которой подключаемся</li>
        <li><b>charset=utf8</b> - тут мы указали кодировку utf8</li>
        <li><b>'root'</b> - логин пользователя имеющий доступ к БД</li>
        <li><b>''</b> - пароль пользователя имеющего доступ к БД (в OpenServer пароль пустой, поэтому указали пустую строку)</li>
    </ul>
    <p>Далее мы создаем переменную, куда поместим данные из таблицы. Для этого обратимся к переменной <b>connection</b> и вызовем у нее метод <b>query</b>. В качестве входного параметра метод <strong>query</strong> принимает SQL запрос</p>
    <img src="./img2.jpg" alt="">
    <p>Дело в том, что <b>query</b> вернет нам объект PDO но уже с данными. Что бы эти данные превратить в удобочитаемый массив вызовем метод <b>fetch</b></p>
    <img src="./img3.jpg" alt="">
    <p>Этот способ удовен усли у нас в таблице одна запись, например для заполнения страницы одноразовыми записями, заголовки разделов и тд. Что бы вывести текст на страницу мы просто обращаемся к <b>aboutData</b> и как в случае с ассоциативным массивом обращаемся к тому элементу к которому нам надо</p>
    <img src="./img4.jpg" alt="">
    <h2>Вывод карточек товара</h2>
    <p>Получаем данные из талицы</p>
    <img src="./img5.jpg" alt="">
    <p>Создаем простой forEach (здесь fetch использовать уже нет необходимости)</p>
    <img src="./img6.jpg" alt="">

    <h2>Добавление записей в таблицу средствами php</h2>
    <p>У нас есть простейшая форма</p>
    <img src="./img7.jpg" alt="">
    <p>Далее получаем данные с формы и с помощью SQL запроса записываем это в БД</p>
    <img src="./img8.jpg" alt="">
    <p>Конкретно в этом примере я столкнулся с проблемой тот что данные хранящиеся в глобальном объекте POST не очищались и при обновлении страницы при пустых полях в таблицу добавлялась запись с данными которые хранились в POST, более того, если я вводил в поля данные и нажимал отправить, в таблицу добавлялись данные  с прошлого POST, а при обновлении страницы в таблицу добавлялись данные уже с новыми значениями хотя по факту форма сбросилась.</p>
    <h2>Изменение записи</h2>
    <img src="./img10.jpg" alt="">
    <p>Большое внимание уделяем конкатенации строк и кавычкам</p>



    <h2>Решение проблемы</h2>
    <p>Для того что бы обнулить глобальный объект $_POST необходимо дописать следующий код</p>
    <img src="./img9.jpg" alt="">
    <p>Иными словами мы редиректим на эту же страницу и при редиректе глобальный объект обнуляется и все прекрасно работает.</p>



</body>
</html>