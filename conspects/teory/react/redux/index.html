<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <h1>Redux</h1>
    <p><b>Redux</b> - это библиотека которая используется для управлением state</p>
    <p>Что бы установить эту библиотек необходимо выполнить команду в терминале</p>
    <span class="code">npm install redux --save</span>
    <p>После того как библиотека загружена создаем файл, называем его (например redux-store.js). В этом файле будем работать с redux</p>
    <h2><span class="num">1</span> создание store</h2>
    <p>Еще раз проговорим что такое store. <b>store</b> - это объект, который содержит в себе сам state, а так же методы изменения state (dispatch). </p>
    <p>Для того что бы создать store у Redux есть метод - который создает store. Этот метод так и называется <b>createStore()</b>. Что бы получить store мы должны создать переменную и поместить в нее результат функции createStore. Перед этим не забываем импортировать createStore</p>
    <img src="prim1.jpg" alt="">
    <p>Теперь store, который мы только что создали имеет все необходимые методы для работы со state</p>
    <ul>
        <li><strong>getState()</strong> - этот метод возвращает текущее состояние state</li>
        <li><strong>dispatch()</strong> - принимает action и передает его всем доступным reducer. После чего перезаписывает ветки в state которые получил от reducer, после чего запускает функцию callSubscriber.</li>
        <li><strong>subscribe(observer)</strong> - эта функция принимает в качестве аргумента функцию render-а страницы и помещает ее в функцию callSubscriber которая вызывается после изменения каждого state. В качестве observer мы передаем функцию отрисовки страницы</li>
    </ul>
    <h2><spam class="num">2</spam> Комбинирование reducer</h2>
    <p>Если сейчас посмотреть на то, как выглядит на данном этапе state, то мы увидим что это пустой объект. Но наша система может быть сложной и иметь множетсво ответвлений в state. Кто в этом случае формирует наш state? А формирует его метод <b>dispatch</b>. При запуске системы store запускает метод <strong>dispatch</strong> cо своим <strong>action</strong>. Как это должно работать? Запускается функция dispatch c неизвестным для reducer action (т.е. там будет прописан type который врятли будет в reducer). В этом случае reducer вернет тот state, который он получил не изменяя его. Тогда встает вопрос, а какой state пришел в reducer вместе с action при инициализации системы? ответ НИКАКОЙ! Поэтому при первом запуске мы получим в качестве state undefined</p>
    <p>Что бы решить эту проблему мы должны создать в <b>reduser</b> state по умолчанию. Для этого создаем объект <b>initialState</b> и в него помещаем структуру участка state за который отвечает reducer. Например:</p>
    <img src="prim2.jpg" alt="">
    <p>Теперь при инициализации функции reducer (а мы помним что reducer это функция, которая принимает state и action) мы записываем аргументы вот так:</p>
    <img src="prim3.jpg" alt="">
    <p>т.е. по умолчанию (если не пришло никакого значения) аргумент state будет иметь значение которое находится в переменной initialState</p>
    <p>Теперь нам необходимо добавить наши reducer в store который мы создали с помощью <strong>createStore</strong>. Здесь первое что нам нужно сделать это скомбинировать все наши reducer. Делается это с помощью функции Redux <b>combineReducers</b>. Эта функция создает объект который в качестве методов будет иметь наши reducer. Перед использованием не забываем импортировать reducer и метод combineReducers</p>
    <img src="prim4.jpg" alt="">
    <p><span class="red">ВАЖНО</span> обращать внимание на то как будут называться ключи объекта</p>
    <img src="prim5.jpg" alt="">
    <p>Так как в state затем будут созданы ветки именно с такими названиями и по этим названиям мы потом будем обращаться к веткам в state</p>
    <p>Теперь что бы наши reducer попали в store мы в качестве аргумента функции <b>createStore</b> передадим только что созданный объект <b>reducers</b></p>
    <img src="prim6.jpg" alt="">
</body>
</html>