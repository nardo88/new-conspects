<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <h1>redux-form</h1>
    <p><b>redux-form</b> - это библиотека, которая добавляет в <b>store</b> reducer и flux круговорот с элементами формы уже происходит с этим участком state который был создан reducer библиотеки redux-form</p>
    <p><a href="https://redux-form.com/8.2.2/docs/gettingstarted.md/" target="_blank">Страница с документацией библиотеки</a></p>
    <p>Для инсталяции библиотеки <b>redux-form</b> в терминале вводим команду</p>
    <span class="code">npm install redux-form --save</span>
    <p><b>redux-form</b> предоставляет нам специальный хок, который вернет нам контейнерную компоненту, которая в свою очередь и будет общаться с тем участком state который был создан redux-form</p>
    <h2>Как использовать</h2>
    <p>Заходим в файл где создается store c помощью redux и импортируем библиотеку <b>redux-form</b></p>
    <img src="prim1.jpg" alt="">
    <p>После чего в <b>combineReducers</b> добавляем новый reducer</p>
    <img src="prim2.jpg" alt="">
    <p><span class="red">ВАЖНО</span> имя ключа задать как <b>form</b></p>
    <p>Теперь нам нужно нашу форму (а вернее компоненту которая отрисовывает нашу форму) обернуть в ХОК - <b>reduxForm</b>. </p>
    <img src="prim3.jpg" alt="">
    <p>Перед этим не забываем импортировать ХОК</p>
    <img src="prim4.jpg" alt="">
    <p>Хок reduxForm принимает в качестве аргумента объект, который созержит свойство - <strong>form</strong> где необходимо указать уникальное имя формы. по этому имени redux-form будет обращатся к форме</p>
    <p>Для того что бы не создавать обработчики событий для полей input (для flux круговорота) мы вместо input будем использовать <b>Field</b>, перед использованием не забываем импортировать их</p>
    <img src="prim5.jpg" alt="">
    <p>Филдам обязательно задаем атрибут <strong>name</strong>, на значения этих атрибутов будет реагировать redux-form. Так же в атрибуте <strong>component</strong> указываем тип филда</p>
    <img src="prim6.jpg" alt="">
    <h2>Как получать данные полей формы?</h2>
    <p>Хок reduxForm прокидывает кучу callback в нашу компоненту. Среди них есть функция которая называется <b>handleSubmit</b>. Для получения данных полей формы вешаем событие на форму <b>onSubmit</b> и передаем туда через пропсы <b>handleSubmit</b></p>
    <img src="prim7.jpg" alt="">
    <p>redux-form после выполнения submit добавить все данные с элементов формы в объект и этот объект передаст callBack - <strong>onSubmit</strong>, т.е. нужно у контейнерной компоненты которые вернул нам Хок reduxForm прокинуть через пропсы callback который должен называться <b>onSubmit</b></p>
    <img src="prim8.jpg" alt="">
    <p>Вот как в целом будет выглядить компонента которая отрисовывает контейнерную компоненту компоненты которая отрисовывает форму (УЖАС!!!)</p>
    <img src="prim9.jpg" alt="">
    <h2>Валидация полей формы</h2>
    <p><b>Валидаторы</b> - это функции которые проверяют входные данные</p>
    <h3>Создание валидотора</h3>
    <p>В папке <b>src</b> создаем каталог, для примера называем его <b>utils</b>. В этой папке создаем <b>validator.js</b> и пишем вот такую функцию.</p>
    <img src="prim10.jpg" alt="">
    <p>Еще раз что такое <b>Валидатор</b>, это функция которая принимает значение поля, проверяет это поле и в зависимости от того что нам нужно возвращает либо <b>undefined</b> либо какую то строчку с ошибкой. Пример выше промерят на заполнение поля. т.е. если value пустое оно вернет false и в этом случае функция вернет строчку "Field is required". Вот пример валидатора которая проверяет максимальное количество введенных символов</p>
    <img src="prim11.jpg" alt="">
    <p>Теперь как сделать так что бы наше поле <b>Field</b> передавало значение в эту функцию, об этом позаботились разработчики <b>Redux-Form</b>. Полю Field мы просто создаем атрибут <b>validate</b> и передаем в него в фигурных скобках валидатор. Если нужно одному полю передать несколько валидаторов, то атрибуту передаем массив где перечисляем валидаторы</p>
    <img src="prim12.jpg" alt="">
    <p>Если мы хотим создать <b>валидотор с использованием замыкания, то нам сначала придется вне Field создать переменную куда поместим результат ValidateCreator и только затем передадим в validator</b></p>
    <p>Пример ValidateCreator</p>
    <img src="prim13.jpg" alt="">
    <p>Сначала перед render получаем замкнутую функцию</p>
    <img src="prim14.jpg" alt="">
    <p>И только потом передаем</p>
    <img src="prim15.jpg" alt="">
    <p>Как вообще это работает? Redux-form обеспечивает контроль flux круговорота. Он сам вызывает наши валидаторы и передает туда значения полей. Вопрос, когда он этоделает? разберем далее.</p>
    <h3>Как добавить эффектов если валидатор что-нибудь вернул?</h3>
    <p>Первое что нужно сделать это создать компоненту, которая отрисовывает поле ввода</p>
    <img src="prim16.jpg" alt="">
    <p>Теперь мы эту компоненту передадим Field-у в атрибуте <strong>component</strong></p>
    <img src="prim17.jpg" alt="">
    <p>Теперь Field прокинет все имеющиеся у себя пропсы в нашу компоненту (и свойства и колбэки) <span class="red">НО</span> если сейчас вывести в косноль что пришло компоненте Input в пропсах то мы вот что увидим:</p>
    <img src="prim18.jpg" alt="">
    <p>В разделе input будут храниться обработчики событий, значение value и имя поля. В meta есть разделы error и touched которые хранят в себе информацию о том вернул ли ошибку валидатор и было ли поле затронут (т.е. получило и тут же потеряло фокус) помимо meta и input в пропсах могут находится обычные атрибута тега, такие как placeholder. Что бы получить эти данные в отдельных переменных применим оператор rest</p>
    <img src="prim19.jpg" alt="">
    <p>Теперь создадим CSS файл которым подключим к компоненте которая отрисовывает поле input и добавим там класс error который будет добавлять красную обводку поля. Далее создаем условие </p>
    <img src="prim20.jpg" alt="">
    <p>если поле было затронуто и валидатор вернул ошибку тогда в переменную помещаем строку с классом ошибки иначе возвращаем пустую строку. Теперь все что остается это передать все атрибуты которые хранятся в разделе input пропсов и обычные атрибуты тега. С помощью spread раскукоживаем их в теле input</p>
    <img src="prim21.jpg" alt="">



</body>
</html>